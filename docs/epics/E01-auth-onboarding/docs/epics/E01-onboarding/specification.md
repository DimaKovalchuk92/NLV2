# E1: Onboarding & Identity - Специфікація

## 1. Контекст
Цей епік охоплює повний цикл залучення нових користувачів на платформу: реєстрацію, автентифікацію та початкове налаштування профілю. Він є фундаментом для всіх подальших взаємодій у системі та має забезпечити безпечний, швидкий і зрозумілий вхід для двох ключових ролей: Спеціаліста та Клієнта.

- **Для Спеціаліста**: процес має бути структурованим, вести через усі необхідні кроки для підготовки до роботи (профіль, розклад, платежі) та завершуватися можливістю запросити першого клієнта.
- **Для Клієнта**: процес має бути максимально простим, особливо при переході за запрошенням від спеціаліста, з мінімальною кількістю кроків до початку взаємодії.

## 2. Цілі (Goals)
1.  **Створити безпечну систему автентифікації**, що підтримує вхід за паролем, через соцмережі (OAuth) та двофакторну автентифікацію (2FA).
2.  **Реалізувати покроковий майстер налаштування (wizard) для Спеціаліста**, який проведе його від реєстрації до повної готовності приймати клієнтів.
3.  **Забезпечити "безшовний" вхід для Клієнта**, який отримує запрошення, з автоматичним створенням зв'язку зі спеціалістом.
4.  **Забезпечити відповідність вимогам безпеки** для медичних даних, включаючи верифікацію email, надійні паролі та управління сесіями.

## 3. User Stories та Критерії Прийняття (Acceptance Criteria)

### 3.1. Реєстрація та Вхід (Спеціаліст та Клієнт)
- **As a user, I can register with email/password.**
  - **AC:** Форма реєстрації вимагає email та пароль. Пароль має відповідати вимогам надійності (мін. 10 символів). Після реєстрації на email надсилається лист для верифікації. Обліковий запис неактивний до верифікації.
- **As a user, I can log in via email/password or OAuth (Google, Apple).**
  - **AC:** Сторінка входу надає опції входу через email/пароль та кнопки для Google/Apple. Успішний вхід створює сесію та видає JWT токени (access + refresh). Спроби входу обмежені (rate-limited) для запобігання брутфорсу.
- **As a user, I can enable 2FA (TOTP).**
  - **AC:** В налаштуваннях безпеки є можливість увімкнути 2FA. Процес включає сканування QR-коду через authenticator app та генерацію резервних кодів. При вході з нового пристрою система вимагає 2FA-код.
- **As a user, I can reset my password securely.**
  - **AC:** Форма "Забули пароль" надсилає на email тимчасове посилання для скидання (дійсне 1 годину). Після успішного скидання пароля всі інші активні сесії користувача анулюються.

### 3.2. Онбординг Спеціаліста (E11)
- **As a new specialist, I complete a step-by-step setup wizard.**
  - **AC:** Після першого входу запускається візард з 4 кроків:
    1.  **Профіль**: ім'я, фото, біографія, спеціалізації, мови.
    2.  **Розклад**: налаштування своєї доступності (тижневі слоти).
    3.  **Платежі**: підключення Stripe акаунту.
    4.  **Запрошення**: можливість запросити першого клієнта.
  - **AC:** Спеціаліст може пропустити крок і повернутися до нього пізніше. Прогрес візарду відображається на дашборді у вигляді чек-листа готовності.
- **As a new specialist, I can do a test call.**
  - **AC:** В кабінеті є кнопка "Тестовий дзвінок", яка запускає sandbox-сесію для перевірки камери, мікрофону та якості з'єднання.

### 3.3. Онбординг Клієнта (E12)
- **As a new client, I can register in 3-4 steps.**
  - **AC:** Процес реєстрації для клієнта, що прийшов самостійно, включає: Ім'я -> Email -> Згода з правилами -> Верифікація email.
- **As a client invited by a specialist, I land directly on our Case.**
  - **AC:** Клієнт, що переходить за deep-link із запрошення, після швидкої реєстрації (або входу) одразу потрапляє на сторінку `Case`, де бачить свого спеціаліста та заплановану сесію.
- **As a client, I do a pre-session tech check before my first session.**
  - **AC:** За 5 хвилин до першої сесії автоматично запускається перевірка камери, мікрофону та швидкості інтернету з чіткими рекомендаціями у разі проблем.

## 4. Критерії Успіху MVP (Success Criteria)
- **Specialists onboarded:** 50+ активних спеціалістів, що завершили візард та провели хоча б одну сесію.
- **Specialist setup time:** < 30 хвилин від моменту реєстрації до повної готовності приймати клієнтів.
- **Time-to-first-session:** < 48 годин від моменту реєстрації клієнта до першої проведеної сесії.