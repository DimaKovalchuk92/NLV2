# E1: Onboarding & Identity - Декомпозиція Задач

| ID  | User Story / Task                                                              | SP | Agent     | Sprint | Dependencies      |
|:----|:-------------------------------------------------------------------------------|:---|:----------|:-------|:------------------|
| 1.1 | **Backend: Основи Автентифікації**                                             |    |           | S1-S2  | -                 |
| 1.2 | Створити Prisma-схему для `auth_schema` (таблиці `users`, `user_profiles`)      | 3  | GPT-5.2   | S1     | -                 |
| 1.3 | Реалізувати `AuthModule` та `UsersModule` в NestJS                             | 2  | GPT-5.2   | S1     | 1.2               |
| 1.4 | Реалізувати `POST /auth/register` з Zod валідацією та хешуванням паролю        | 5  | Sonnet 4.5| S1     | 1.3               |
| 1.5 | Реалізувати `POST /auth/login` з Passport.js (local strategy), що повертає JWT | 5  | Sonnet 4.5| S1     | 1.4               |
| 1.6 | Налаштувати email-сервіс для надсилання верифікаційних посилань                | 3  | Haiku 4.5 | S2     | 1.4               |
| 1.7 | Реалізувати `GET /auth/verify-email/:token` для підтвердження пошти            | 3  | Sonnet 4.5| S2     | 1.6               |
| 1.8 | Налаштувати стратегію `passport-jwt` та Guard для захисту ендпоінтів           | 3  | Sonnet 4.5| S2     | 1.5               |
|     |                                                                                |    |           |        |                   |
| 2.1 | **Frontend: Форми Входу/Реєстрації**                                           |    |           | S1-S2  | -                 |
| 2.2 | Оновити `handleRegister` в `index.html` для створення профілю в `MockAPI`      | 3  | GPT-5.2   | S1     | -                 |
| 2.3 | Оновити `handleLogin` для перенаправлення на `admin.html` або `cabinet.html`   | 2  | GPT-5.2   | S1     | 2.2               |
| 2.4 | Створити UI для сторінки "Перевірте ваш email"                                 | 2  | Haiku 4.5 | S2     | 1.6               |
|     |                                                                                |    |           |        |                   |
| 3.1 | **Backend: Онбординг Спеціаліста**                                             |    |           | S2     | 1.3               |
| 3.2 | Створити `PATCH /profiles/me` ендпоінт для оновлення профілю спеціаліста       | 5  | Sonnet 4.5| S2     | 1.8               |
| 3.3 | Додати логіку для встановлення `onboardingComplete: true` після заповнення     | 2  | GPT-5.2   | S2     | 3.2               |
|     |                                                                                |    |           |        |                   |
| 4.1 | **Frontend: Візард Онбордингу Спеціаліста**                                    |    |           | S2-S3  | -                 |
| 4.2 | Створити в `admin.html` логіку, що показує візард, якщо `onboardingComplete: false` | 3  | Sonnet 4.5| S2     | 2.2               |
| 4.3 | Створити UI для кроку 1 візарду (Профіль) та підключити до API (`PATCH /profiles/me`) | 5  | Sonnet 4.5| S2     | 3.2, 4.2          |
| 4.4 | Створити UI-заглушки для кроків 2 (Розклад) та 3 (Платежі)                     | 3  | Haiku 4.5 | S3     | 4.2               |
| 4.5 | Створити UI для кроку 4 (Запрошення клієнта)                                   | 2  | Haiku 4.5 | S3     | 4.2               |
|     |                                                                                |    |           |        |                   |
| 5.1 | **Додаткова Безпека та Тести**                                                 |    |           | S3     | -                 |
| 5.2 | Написати Unit та інтеграційні тести для всіх ендпоінтів автентифікації         | 8  | Haiku 4.5 | S3     | 1.5, 1.7          |
| 5.3 | Реалізувати `POST /auth/logout` для анулювання refresh токена                  | 3  | Sonnet 4.5| S3     | 1.5               |
| 5.4 | Реалізувати `POST /auth/refresh` для оновлення access токенів                  | 3  | Sonnet 4.5| S3     | 1.5               |

---
**Всього Story Points:** 57