<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Life Vision | –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        :root { --brand-grad: linear-gradient(to right, #3b82f6, #10b981, #facc15); }

        .btn-grow {
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer !important;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 50;
        }
        .btn-grow:hover { transform: scale(1.05); }

        @keyframes breathe {
            0%, 100% { transform: scale(0.8); opacity: 0.4; }
            40%, 60% { transform: scale(1.4); opacity: 1; }
        }
        @keyframes textCycle {
            0%, 100% { content: "–í—ã–¥–æ—Ö..."; color: #64748b; }
            5%, 35% { content: "–í–¥–æ—Ö..."; color: #3b82f6; }
            40%, 65% { content: "–ó–∞–¥–µ—Ä–∂–∏—Ç–µ..."; color: #10b981; }
        }
        .breath-hint::after { content: "–î—ã—à–∏—Ç–µ..."; animation: textCycle 8s infinite; }
        .breath-circle {
            width: 200px; height: 200px; border-radius: 50%;
            background: radial-gradient(circle, #3b82f6 0%, #93c5fd 100%);
            animation: breathe 8s infinite ease-in-out;
            box-shadow: 0 0 60px rgba(59, 130, 246, 0.3);
        }

        .auth-modal {
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity .28s ease, visibility .28s ease;
        }
        .auth-modal .modal-window {
            transform: translateY(12px) scale(.98);
            transition: transform .32s cubic-bezier(.2,.9,.2,1), opacity .28s ease;
            opacity: 0;
        }
        .auth-modal.open {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        .auth-modal.open .modal-window {
            transform: translateY(0) scale(1);
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans min-h-screen overflow-x-hidden">

    <nav class="flex justify-between items-center p-8 max-w-7xl mx-auto">
        <div class="text-2xl font-black italic tracking-tighter">
            NEW LIFE <span class="text-blue-600">VISION</span>
        </div>
        <button class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold btn-grow shadow-lg">–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</button>
    </nav>

    <header class="max-w-7xl mx-auto px-6 py-24 text-center">
        <h1 class="text-7xl font-black mb-8 leading-tight tracking-tight">New Life Vision</h1>
        <p class="text-xl text-slate-500 max-w-2xl mx-auto mb-12">
            –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–ø—Ä–∞–∫—Ç–∏–∫–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ–º–æ–≥–∞—é—â–∏—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–π. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å.
        </p>
        
        <div id="auth-buttons" class="flex flex-col md:flex-row justify-center gap-6 relative z-10">
            <button onclick="openAuth('client')" class="btn-grow bg-white border border-slate-200 px-10 py-5 rounded-2xl shadow-sm font-bold text-lg text-slate-900">
                üîç –ù–∞–π—Ç–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
            </button>
            <button onclick="openAuth('admin')" class="btn-grow bg-slate-900 text-white px-10 py-5 rounded-2xl shadow-xl font-bold text-lg">
                üöÄ –Ø –ø—Ä–æ—Ñ–∏
            </button>
        </div>
    </header>

    <section class="max-w-6xl mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-10 pb-32">
        <div class="format-card p-10 border border-slate-100">
            <div class="w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center text-4xl mb-8">üë§</div>
            <h3 class="text-2xl font-bold mb-4">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ</h3>
            <p class="text-slate-500 text-lg">–†–∞–±–æ—Ç–∞ 1:1 —Å –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π —Å–µ—Å—Å–∏–π –∏ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —á–∞—Ç–æ–º.</p>
        </div>
        <div class="format-card p-10 border border-slate-100">
            <div class="w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center text-4xl mb-8">üë•</div>
            <h3 class="text-2xl font-bold mb-4">–ì—Ä—É–ø–ø–æ–≤–∞—è —Ç–µ—Ä–∞–ø–∏—è</h3>
            <p class="text-slate-500 text-lg">–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≥—Ä—É–ø–ø—ã –∏ –ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.</p>
        </div>
        <div class="format-card p-10 border border-slate-100">
            <div class="w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center text-4xl mb-8">üèÜ</div>
            <h3 class="text-2xl font-bold mb-4">–ú–∞—Ä–∞—Ñ–æ–Ω—ã</h3>
            <p class="text-slate-500 text-lg">–ü—Ä–æ–≥—Ä–∞–º–º—ã —Å –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —á–µ—Ä–µ–∑ –ü—É—Ç—å –≥–µ—Ä–æ—è.</p>
        </div>
    </section>

    <button onclick="document.getElementById('g').style.display='flex'" class="fixed bottom-10 right-10 bg-red-500 text-white w-20 h-20 rounded-full shadow-2xl flex items-center justify-center text-4xl z-50 hover:scale-110 transition-transform">üßò‚Äç‚ôÇÔ∏è</button>

    <div id="g" style="display:none;" class="fixed inset-0 bg-white/98 backdrop-blur-2xl z-[100] flex-col items-center justify-center text-center">
        <h2 class="breath-hint text-5xl font-black mb-16 h-16"></h2>
        <div class="breath-circle mb-16 mx-auto"></div>
        <button onclick="document.getElementById('g').style.display='none'" class="btn-grow bg-slate-100 text-slate-500 px-10 py-4 rounded-full font-bold uppercase tracking-widest text-sm hover:text-red-500">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
    </div>

    <div id="auth-modal" class="auth-modal fixed inset-0 bg-slate-900/40 backdrop-blur-md z-[150] items-center justify-center p-4" aria-hidden="true">
        <div class="modal-window bg-white w-full max-w-md rounded-[2.5rem] p-10 shadow-2xl">
            <h2 id="modal-title" class="text-3xl font-black mb-2">–í—Ö–æ–¥</h2>
            <p id="modal-desc" class="text-slate-500 mb-8 text-sm italic">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ New Life Vision</p>
            
            <div class="space-y-4 text-left">
                <input type="text" id="name" class="hidden w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–í–∞—à–µ –∏–º—è">
                
                <input type="email" id="email" class="w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–í–∞—à Email">
                
                <input type="password" id="password" class="w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 10 —Å–∏–º–≤–æ–ª–æ–≤)">
                
                <input type="password" id="password-confirm" class="hidden w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å">

                <div id="specialist-fields" class="hidden space-y-4 pt-4 border-t border-slate-200 mt-4">
                    <div>
                        <label class="block text-sm font-bold text-slate-500 mb-2">–í–∞—à–∞ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è</label>
                        <input type="text" id="specialization" class="w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–ù–∞–ø—Ä. –ü—Å–∏—Ö–æ–ª–æ–≥">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-500 mb-2">–ü—Ä–æ —Å–µ–±–µ</label>
                        <textarea id="bio" class="w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–î–æ—Å–≤—ñ–¥ —Ä–æ–±–æ—Ç–∏" rows="3"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-500 mb-2">–í—ñ—Ç–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</label>
                        <textarea id="welcomeMessage" class="w-full px-6 py-4 bg-slate-50 border border-slate-100 rounded-2xl focus:border-blue-500 outline-none" placeholder="–ü—Ä–∏–≤—ñ—Ç –∫–ª—ñ—î–Ω—Ç—É" rows="3"></textarea>
                    </div>
                </div>
            </div>

            <div class="mt-8 flex gap-4">
                <button onclick="closeAuth()" class="flex-1 py-4 font-bold text-slate-400">–û—Ç–º–µ–Ω–∞</button>
                <button onclick="handleLogin()" id="login-btn" class="flex-1 bg-blue-600 text-white py-4 rounded-2xl font-bold shadow-lg">–í–æ–π—Ç–∏</button>
                <button onclick="handleRegister()" id="register-btn" class="hidden flex-1 bg-green-600 text-white py-4 rounded-2xl font-bold shadow-lg">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            <div class="mt-4 text-center">
                <a href="#" onclick="toggleAuthMode(event)" id="auth-mode-toggle" class="text-sm font-bold text-blue-600 hover:underline">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
            </div>
        </div>
    </div>

    <script src="modules/mock-api.js"></script>
    <script>
        let currentRole = '';
        let isRegisterMode = false;

        function checkAuth() {
            const user = MockAPI.getLoggedInUser();
            const authButtons = document.getElementById('auth-buttons');
            
            if (user && authButtons) {
                const targetPage = user.role === 'admin' ? 'admin.html' : 'cabinet.html';
                authButtons.innerHTML = `
                    <div class="flex flex-col items-center gap-4">
                        <a href="${targetPage}" class="btn-grow bg-blue-600 text-white px-10 py-5 rounded-2xl shadow-xl font-bold text-lg no-underline">
                            –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞–±–∏–Ω–µ—Ç ‚Üí
                        </a>
                        <button onclick="logout()" class="text-slate-400 font-bold hover:text-red-500 transition">–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã</button>
                    </div>
                `;
            }
        }

        function openAuth(role) {
            currentRole = role;
            isRegisterMode = false;
            
            const modal = document.getElementById('auth-modal');
            const title = document.getElementById('modal-title');
            const nameInput = document.getElementById('name');
            const emailInput = document.getElementById('email');
            const passConfirmInput = document.getElementById('password-confirm');
            const loginBtn = document.getElementById('login-btn');
            const registerBtn = document.getElementById('register-btn');
            const toggleLink = document.getElementById('auth-mode-toggle');
            const specialistFields = document.getElementById('specialist-fields');
            
            title.innerText = role === 'admin' ? "–í—Ö–æ–¥ –¥–ª—è –ü–†–û–§–ò" : "–í—Ö–æ–¥ –¥–ª—è –ö–õ–ò–ï–ù–¢–ê";
            nameInput.classList.add('hidden');
            passConfirmInput.classList.add('hidden');
            emailInput.placeholder = '–í–∞—à Email';
            loginBtn.classList.remove('hidden');
            registerBtn.classList.add('hidden');
            toggleLink.innerText = '–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
            specialistFields.classList.add('hidden');

            modal.classList.add('open');
        }

        function closeAuth() {
            document.getElementById('auth-modal').classList.remove('open');
        }

        function handleLogin() {
            const email = document.getElementById('email').value.trim();
            const pass = document.getElementById('password').value.trim();

            const user = MockAPI.loginUser(email, pass);

            if (user) {
                if (user.role !== currentRole) {
                    alert(`–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Ö–æ–¥ –¥–ª—è ${user.role === 'admin' ? '–ü–†–û–§–ò' : '–ö–õ–ò–ï–ù–¢–ê'}.`);
                    return;
                }
                window.location.href = user.role === 'admin' ? 'admin.html' : 'cabinet.html';
            } else {
                alert("–û—à–∏–±–∫–∞! –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å.");
            }
        }

        function handleRegister() {
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const pass = document.getElementById('password').value.trim();
            const confirmPass = document.getElementById('password-confirm').value.trim();

            if (!name || !email || !pass) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.');
                return;
            }

            // Architecture Security: Min 10 characters
            if (pass.length < 10) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤.');
                return;
            }

            // UI UX: Match Check
            if (pass !== confirmPass) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
                return;
            }

            let profileData = {
                fullName: name,
                onboardingComplete: currentRole !== 'admin'
            };

            if (currentRole === 'admin') {
                const spec = document.getElementById('specialization').value.trim();
                profileData.specializations = spec ? [spec] : [];
                profileData.bio = document.getElementById('bio').value.trim();
                profileData.welcomeMessage = document.getElementById('welcomeMessage').value.trim();
            }

            const newUser = MockAPI.registerUser(currentRole, name, email, pass, profileData);

            if (newUser && !newUser.error) {
                alert(`–£—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–∏–º Email.`);
                toggleAuthMode({ preventDefault: () => {} });
            } else if (newUser && newUser.error === 'password_too_short') {
                alert('–û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π.');
            } else {
                alert('–≠—Ç–æ—Ç Email —É–∂–µ –∑–∞–Ω—è—Ç.');
            }
        }

        function toggleAuthMode(event) {
            event.preventDefault();
            isRegisterMode = !isRegisterMode;

            const modalTitle = document.getElementById('modal-title');
            const nameInput = document.getElementById('name');
            const passConfirmInput = document.getElementById('password-confirm');
            const loginBtn = document.getElementById('login-btn');
            const registerBtn = document.getElementById('register-btn');
            const toggleLink = document.getElementById('auth-mode-toggle');
            const specialistFields = document.getElementById('specialist-fields');

            if (isRegisterMode) {
                modalTitle.innerText = "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è";
                nameInput.classList.remove('hidden');
                passConfirmInput.classList.remove('hidden');
                loginBtn.classList.add('hidden');
                registerBtn.classList.remove('hidden');
                toggleLink.innerText = '–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏';
                if (currentRole === 'admin') specialistFields.classList.remove('hidden');
            } else {
                modalTitle.innerText = "–í—Ö–æ–¥";
                nameInput.classList.add('hidden');
                passConfirmInput.classList.add('hidden');
                loginBtn.classList.remove('hidden');
                registerBtn.classList.add('hidden');
                toggleLink.innerText = '–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
                specialistFields.classList.add('hidden');
            }
        }

        function logout() {
            MockAPI.logoutUser();
            window.location.reload();
        }

        document.addEventListener('DOMContentLoaded', () => {
            MockAPI.init();
            checkAuth();
        });
    </script>
</body>
</html>